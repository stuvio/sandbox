!function(){angular.module("stuvio",["stuvio.components","templates"]),angular.module("sandbox",["stuvio"]).run(["$rootScope",function(e){e.warnings=[]}]).filter("authors",function(){var e='<a href="{{href}}" target="_blank">{{name}}</a>';return function(n,t){return n&&n.length?n.map(function(n){var r=n.match(/^([^<(]+)/),i=n.match(/\(([^\)]+)\)/);return r=r[0].replace(/^\s+|\s+$/,""),i&&t?e.replace("{{name}}",r).replace("{{href}}",i?i[1]:""):r}).join(", "):void 0}}).service("GeneratorService",["$q","$http","$rootScope",function(n,t,r){var i=r.warnings=[],o={generator:null,init:function(){return n(function(n,i){self.Generator&&e.isObject(self.Generator)?t.get("./generator.json").success(function(t){e.merge(Generator,t),o.checkGenerator(Generator),Generator.seed=Generator.seed||4294967295*Math.random(),o.generator=Generator,r.warnings.length?i():o.generator.initialize(function(){o.checkContext(Generator.context),n(Generator),o.generate()})}).error(function(){i({title:"No generator.json found",info:"You must provide a generator.json file describing your application"})}):i({title:"No Generator found",info:"Have you linked the source files in index.html and exposed a `Generator` object?"})})},generate:function(){stuvio.random.seed=o.generator.seed,o.generator.generate(function(){})},checkGenerator:function(n){return n.id||i.push({title:"No ID specified in generator.json"}),n.name||i.push({title:"No name specified in generator.json"}),n.version||i.push({title:"No version specified in generator.json"}),/^[\d\.]+$/.test(n.version)||i.push({title:"Invalid version in generator.json",info:"Please use Semantic Versioning (major.minor.patch), for example 1.0.0"}),n.authors&&n.authors.length&&e.isArray(n.authors)||i.push({title:"No author(s) specified in generator.json"}),n.description||i.push({title:"No description provided in generator.json"}),n.settings||i.push({title:"No `settings` property found",info:"Please expose some settings for your generator"}),n.settings&&!Object.keys(n.settings).length&&i.push({title:"No properties found in the settings object",info:"Please provide some settings inside your settings object"}),e.isFunction(n.initialize)?n.initialize.length||i.push({title:"No arguments found for the `initialize` method",info:"The `initialize` method should receive a callback which is called when your generator has finished initialising"}):i.push({title:"No `initialize` method found",info:"You must provide an initialize method"}),e.isFunction(n.generate)?n.generate.length||i.push({title:"No arguments found for the `generate` method",info:"The `generate` method should receive a callback which is called when your generator has finished generating"}):i.push({title:"No `generate` method found",info:"You must provide a generate method"}),e.isFunction(n.destroy)?n.destroy.length||i.push({title:"No arguments found for the `destroy` method",info:"The `destroy` method should receive a callback which is called when your generator has finished tearing down"}):i.push({title:"No `destroy` method found",info:"You must provide a destroy method"}),i},checkContext:function(e){e?e instanceof CanvasRenderingContext2D||e instanceof WebGLRenderingContext||i.push({title:"Unrecognized context type",info:"The provided context should be of type CanvasRenderingContext2D or WebGLRenderingContext"}):i.push({title:"No `context` property found",info:"Please expose the Canvas or WebGL context in the generator object"})}};return o}]).controller("SandboxController",["$scope","$rootScope","GeneratorService",function(e,n,t){e.warnings=n.warnings,t.init().then(function(n){Object.keys(n.settings).forEach(function(n){e.$watch("generator.settings."+n+".value",t.generate)}),e.generator=n},function(n){n&&e.warnings.push(n)})}]),self.stuvio=self.stuvio||{},self.stuvio.env=self.env||"web",self.stuvio=self.stuvio||{},self.stuvio.random=function(){function e(e){return"number"==typeof e&&!isNaN(e)}function n(){return(n.seed=16807*n.seed%i)/i+2.33e-10}var t,r=!1,i=2147483647;return n.mutate=function(){return n.seed=Math.random()*i},n.gaussian=function(e,i){if(e=e||0,i=i||1,r)return r=!1,t*i+e;var o,a,s,l;do o=2*n()-1,a=2*n()-1,s=o*o+a*a;while(s>=1||0===s);return l=Math.sqrt(-2*Math.log(s)/s),r=!0,t=a*l*.5,o*l*.5*i+e},n.float=function(t,r){return e(t)?e(r)||(r=t,t=0):t=0,t+n()*(r-t)},n.int=function(e,t){return Math.round(n.float(e,t))},n.sign=function(t){return n()>=(e(t)?t:.5)?-1:1},n.bool=function(t){return Boolean(n()<(e(t)?t:.5))},n.bit=function(t){return Number(n()<(e(t)?t:.5))},n.item=function(e){return e[~~(n()*e.length)]},n.mutate(),n}(),function(){var e={EPS:1e-4,RADIANS:Math.PI/180,DEGREES:180/Math.PI,HALF_PI:Math.PI/2,TWO_PI:2*Math.PI,sign:function(e){return 0>e?-1:1},clamp:function(e,n,t){return Math.min(t,Math.max(n,e))},lerp:function(e,n,t){return e+t*(n-e)},step:function(e,n){return n*Math.round(e/n)},map:function(e,n,t,r,i){return(e-n)/(t-n)*(i-r)+r}};for(var n in e)Math[n]=e[n]}();var e=e||function(){var n={};return{isFunction:function(e){return"[object Function]"===n.toString.call(e)},isNumber:function(e){return"number"==typeof e},isObject:function(e){return e.constructor==Object},isArray:function(e){return Array.isArray(e)},defaults:function(e,n){for(var t in n)t in e||(e[t]=n[t]);return e},extend:function(e,n){for(var t in n)e[t]=n[t];return e},each:function(n,t){e.isObject(n)?Object.keys(n).forEach(function(e){t(n[e],e,n)}):n.forEach(t)},clone:function(e){return JSON.parse(JSON.stringify(e))},merge:function(n,t){if(e.isObject(t)){n=n||{};for(var r in t)n[r]=e.merge(n[r],t[r])}else e.isArray(t)?(n=n||[],t.forEach(function(t,r){n[r]=e.merge(n[r],t)})):n=t;return n},find:function(e,n){for(var t,r,i=0,o=e.length;o>i;i++){t=e[i],r=!0;for(var a in n)if(t[a]!==n[a]){r=!1;break}if(r)return t}},transform:function(e,n){var t={};for(var r in e)n(t,e[r],r);return t}}}();angular.module("templates",[]).run(["$templateCache",function(e){e.put("components/checkout/checkout.html",'\n<div class="wrapper">\n\n    <form name="orderForm" class="row" ng-submit="submitForm(orderForm)" novalidate>\n        \n        <!-- shipping -->\n        \n        <div class="shipping col-1-3">\n            <header class="header">\n                <h4 class="title">Shipping details</h4>\n            </header>\n            <sv-input name="shippingName" class="input" type="text" value="order.shipping.name" placeholder="Name" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.shippingName.$touched">\n                    <span ng-show="orderForm.shippingName.$error.required">Enter your name</span>\n                </div>\n            </sv-input>\n            <sv-input name="shippingAddress" class="input" type="text" value="order.shipping.address" placeholder="Address 1" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.shippingAddress.$touched">\n                    <span ng-show="orderForm.shippingAddress.$error.required">Enter your address</span>\n                </div>\n            </sv-input>\n            <sv-input name="shippingCity" class="input" type="text" value="order.shipping.city" placeholder="City" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.shippingCity.$touched">\n                    <span ng-show="orderForm.shippingCity.$error.required">Enter your city</span>\n                </div>\n            </sv-input>\n            <div class="row">\n                <div class="col-1-2">\n                    <sv-input name="shippingRegion" class="input" type="text" value="order.shipping.region" placeholder="State or Region" required>\n                        <div class="error" ng-show="orderForm.$submitted || orderForm.shippingRegion.$touched">\n                            <span ng-show="orderForm.shippingRegion.$error.required">Enter state or region</span>\n                        </div>\n                    </sv-input>\n                </div>\n                <div class="col-1-2">\n                    <sv-input name="shippingPostcode" class="input" type="text" value="order.shipping.postcode" placeholder="Post / Zip Code" required>\n                        <div class="error" ng-show="orderForm.$submitted || orderForm.shippingPostcode.$touched">\n                            <span ng-show="orderForm.shippingPostcode.$error.required">Enter your post or zip code</span>\n                        </div>\n                    </sv-input>\n                </div>\n            </div>\n            <div class="select" ng-class="{ blank: !order.shipping.country }">\n                <select name="shippingCountry" ng-model="order.shipping.country" required>\n                    <option value="GB">United Kingdom</option>\n                    <option value="US">United States</option>\n                </select>\n                <div class="placeholder">Country</div>\n                <x-icon class="toggle" type="arrow-down"></x-icon>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.shippingCountry.$touched">\n                    <span ng-show="orderForm.shippingCountry.$error.required">Enter your country</span>\n                </div>\n            </div>\n        </div>\n\n        <!-- billing -->\n        \n        <div class="billing col-1-3">\n            <header class="header">\n                <h4 class="title">Billing details</h4>\n                <div class="checkbox">\n                    <input id="useshipping" type="checkbox" ng-model="useShipping">\n                    <label for="useshipping" class="label">\n                        <x-icon type="check"></x-icon> Same as shipping\n                    </label>\n                </div>\n            </header>\n            <sv-input name="billingName" class="input" type="text" ng-disabled="useShipping" value="order[ useShipping ? \'shipping\' : \'billing\' ].name" placeholder="Name" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.billingName.$touched">\n                    <span ng-show="orderForm.billingName.$error.required">Enter your name</span>\n                </div>\n            </sv-input>\n            <sv-input name="billingAddress" class="input" type="text" ng-disabled="useShipping" value="order[ useShipping ? \'shipping\' : \'billing\' ].address" placeholder="Address 1" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.billingAddress.$touched">\n                    <span ng-show="orderForm.billingAddress.$error.required">Enter your address</span>\n                </div>\n            </sv-input>\n            <sv-input name="billingCity" class="input" type="text" ng-disabled="useShipping" value="order[ useShipping ? \'shipping\' : \'billing\' ].city" placeholder="City" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.billingCity.$touched">\n                    <span ng-show="orderForm.billingCity.$error.required">Enter your city</span>\n                </div>\n            </sv-input>\n            <div class="row">\n                <div class="col-1-2">\n                    <sv-input name="billingRegion" class="input" type="text" ng-disabled="useShipping" value="order[ useShipping ? \'shipping\' : \'billing\' ].region" placeholder="State or Region" required>\n                        <div class="error" ng-show="orderForm.$submitted || orderForm.billingRegion.$touched">\n                            <span ng-show="orderForm.billingRegion.$error.required">Enter state or region</span>\n                        </div>\n                    </sv-input>\n                </div>\n                <div class="col-1-2">\n                    <sv-input name="billingPostcode" class="input" type="text" ng-disabled="useShipping" value="order[ useShipping ? \'shipping\' : \'billing\' ].postcode" placeholder="Post / Zip Code" required>\n                        <div class="error" ng-show="orderForm.$submitted || orderForm.billingPostcode.$touched">\n                            <span ng-show="orderForm.billingPostcode.$error.required">Enter your postcode</span>\n                        </div>\n                    </sv-input>\n                </div>\n            </div>\n            <div class="select" ng-class="{ blank: !order[ useShipping ? \'shipping\' : \'billing\' ].country }">\n                <select name="billingCountry" ng-disabled="useShipping" ng-model="order[ useShipping ? \'shipping\' : \'billing\' ].country" required>\n                    <option value="GB">United Kingdom</option>\n                    <option value="US">United States</option>\n                </select>\n                <div class="placeholder">Country</div>\n                <x-icon class="toggle" type="arrow-down"></x-icon>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.billingCountry.$touched">\n                    <span ng-show="orderForm.billingCountry.$error.required">Enter your country</span>\n                </div>\n            </div>\n        </div>\n\n        <!-- payment -->\n\n        <div class="payment col-1-3">\n            <header class="header">\n                <h4 class="title">Payment details</h4>\n            </header>\n            <sv-input name="email" class="input" type="email" value="order.email" placeholder="Email Address" required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.email.$touched">\n                    <span ng-show="orderForm.email.$error.required">Enter your email</span>\n                    <span ng-show="orderForm.email.$error.email">Enter a valid email</span>\n                </div>\n            </sv-input>\n            <sv-input name="cardNumber" class="input" type="text" value="order.card.number" placeholder="Card Number" stripe-validate card required>\n                <div class="error" ng-show="orderForm.$submitted || orderForm.cardNumber.$touched" ng-messages="orderForm.cardNumber.$error">\n                    <div ng-message="required">Enter your card number</div>\n                    <div ng-message="card">Invalid card number</div>\n                </div>\n            </sv-input>\n            <div class="row">\n                <div class="col-1-3">\n                    <div class="select">\n                        <select name="month" class="month" ng-change="orderForm.month.$error.month = false" ng-options="month for month in order.months" ng-model="order.card.month" required></select>\n                        <div class="placeholder">Expiry Month</div>\n                        <div class="error" ng-show="( orderForm.$submitted || orderForm.month.$touched ) && orderForm.month.$error.month">\n                            <x-icon class="warning" type="warning"></x-icon>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-1-3">\n                    <div class="select">\n                        <select name="year" class="year" ng-change="orderForm.year.$error.year = false" ng-options="year for year in order.years" ng-model="order.card.year" required></select>\n                        <div class="placeholder">Expiry Year</div>\n                        <div class="error" ng-show="( orderForm.$submitted || orderForm.year.$touched ) && orderForm.year.$error.year">\n                            <x-icon class="warning" type="warning"></x-icon>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-1-3">\n                    <sv-input name="cvc" class="input cvc" type="text" value="order.card.cvc" placeholder="CVC" ng-minlength="3" ng-maxlength="4" stripe-validate cvc required>\n                        <div class="error" ng-show="orderForm.$submitted || orderForm.cvc.$touched" ng-messages="orderForm.cvc.$error">\n                            <div ng-message="required">Enter CVC</div>\n                            <div ng-message="minlength">Too short</div>\n                            <div ng-message="maxlength">Too long</div>\n                            <div ng-message="cvc">Invalid CVC</div>\n                        </div>\n                    </sv-input>\n                </div>\n            </div>\n            <button class="order button outline" ng-click="orderForm.$submit()">Order</button>\n        </div>\n\n    </form>\n\n    <footer class="footer">\n        <p class="secure">All payments are security processed with industry standard 256-bit encruption using <a href="https://stripe.com/" target="_blank">Stripe</a></p>\n        <a class="terms" href="#">Terms &amp; conditions</a>\n    </footer>\n\n</div>\n\n<button class="close button" ng-click="cancel()">\n    <x-icon type="cross"></x-icon>\n</button>'),e.put("components/gui/gui.html",'\n<div class="component" ng-repeat="(name, setting) in generator.settings" ng-switch="setting.type">\n    \n    <x-slider ng-switch-when="number"\n        description="setting.description"\n        range="setting.range"\n        value="setting.value"\n        step="setting.step"\n        unit="setting.unit"\n        name="setting.label || name">\n    </x-slider>\n\n    <x-string ng-switch-when="string"\n        description="setting.description"\n        value="setting.value"\n        name="setting.label || name">\n    </x-string>\n\n    <x-toggle ng-switch-when="boolean"\n        description="setting.description"\n        value="setting.value"\n        name="setting.label || name">\n    </x-toggle>\n\n    <x-audio ng-switch-when="audio"\n        description="setting.description"\n        interval="setting.interval"\n        duration="setting.duration"\n        bands="setting.bands"\n        value="setting.value"\n        name="setting.label || name">\n    </x-audio>\n    \n    <x-image ng-switch-when="image"\n        description="setting.description"\n        setting="setting"\n        name="setting.label || name">\n    </x-image>\n\n    <x-color ng-switch-when="color"\n        description="setting.description"\n        value="setting.value"\n        name="setting.label || name">\n    </x-color>\n\n</div>'),e.put("components/input/input.html",'<input ng-model="value"/>\n<div class="placeholder" ng-class="{ small: ( value || rawValue ).length }">{{ placeholder }}</div>\n<ng-transclude></ng-transclude>\n<div ng-if="info" class="info">{{ info }}</div>'),e.put("components/modal/modal.html",'<div id="modal" ng-class="mode" ng-show="show">\n    <div class="content">\n        <p>mode: {{ mode }}</p>\n        <h3 ng-if="config.title">title: {{ config.title }}</h3>\n        <p ng-if="config.message">message: {{ config.message }}</p>\n        <ol>\n            <li ng-repeat="option in config.options">\n                <button ng-click="close( option.action )">{{ option.label }}</button>\n            </li>\n        </ol>\n    </div>\n</div>'),e.put("components/preview/preview.html",'<div class="frame">\n    <div class="content"></div>\n</div>'),e.put("components/status/status.html",'<div id="status" ng-show="active">\n    <div class="content">\n        <svg class="spinner" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 500 500" enable-background="new 0 0 500 500" xml:space="preserve">\n            <defs>\n                <clipPath id="ca">\n                    <rect transform="translate(1000,0)" id="ma" x="249.5" y="62.53" width="64.98" height="112.41"/>\n                </clipPath>\n                <clipPath id="cb">\n                    <rect transform="translate(1000,0)" id="mb" x="184.52" y="99.97" width="129.96" height="150.03"/>\n                </clipPath>\n                <clipPath id="cc">\n                    <rect transform="translate(1000,0)" id="mc" x="184.52" y="174.94" width="129.96" height="150.121"/>\n                </clipPath>\n                <clipPath id="cd">\n                    <rect transform="translate(1000,0)" id="md" x="184.52" y="250" width="129.96" height="150.03"/>\n                </clipPath>\n                <clipPath id="ce">\n                    <rect transform="translate(1000,0)" id="me" x="184.52" y="325.061" width="64.98" height="112.409"/>\n                </clipPath>\n            </defs>\n            <animateTransform id="ame1" xlink:href="#me" attributeName="transform" type="translate" begin="0.1s; amb2.end-0.1s" dur="0.25s" from="75 0" to="0 0" fill="freeze"/>\n            <animateTransform id="amd1" xlink:href="#md" attributeName="transform" type="translate" begin="ame1.end-0.05s" dur="0.25s" from="-150 0" to="0 0" fill="freeze"/>\n            <animateTransform id="amc1" xlink:href="#mc" attributeName="transform" type="translate" begin="amd1.end-0.05s" dur="0.25s" from="150 0" to="0 0" fill="freeze"/>\n            <animateTransform id="amb1" xlink:href="#mb" attributeName="transform" type="translate" begin="amc1.end-0.05s" dur="0.25s" from="-150 0" to="0 0" fill="freeze"/>\n            <animateTransform id="ama1" xlink:href="#ma" attributeName="transform" type="translate" begin="amb1.end-0.05s" dur="0.25s" from="75 0" to="0 0" fill="freeze"/>\n            <animateTransform id="ame2" xlink:href="#me" attributeName="transform" type="translate" begin="amb1.end" dur="0.25s" from="0 0" to="-75 0" fill="freeze"/>\n            <animateTransform id="amd2" xlink:href="#md" attributeName="transform" type="translate" begin="ame2.end-0.05s" dur="0.25s" from="0 0" to="150 0" fill="freeze"/>\n            <animateTransform id="amc2" xlink:href="#mc" attributeName="transform" type="translate" begin="amd2.end-0.05s" dur="0.25s" from="0 0" to="-150 0" fill="freeze"/>\n            <animateTransform id="amb2" xlink:href="#mb" attributeName="transform" type="translate" begin="amc2.end-0.05s" dur="0.25s" from="0 0" to="150 0" fill="freeze"/>\n            <animateTransform id="ama2" xlink:href="#ma" attributeName="transform" type="translate" begin="amb2.end-0.05s" dur="0.25s" from="0 0" to="-75 0" fill="freeze"/>\n            <polygon id="outline" opacity="0.1" points="444.35,362.5 249.5,475 54.65,362.5 54.65,137.5 249.5,25 444.35,137.5"/>\n            <polygon id="c" class="segment" clip-path="url(#cc)" opacity="0.65" points="184.52,250 184.52,174.94 314.48,250 314.48,325.061"/>\n            <polygon id="e" class="segment" clip-path="url(#ce)" opacity="0.65" points="184.52,325.061 184.52,400.03 249.5,437.47 249.5,362.5"/>\n            <polygon id="a" class="segment" clip-path="url(#ca)" opacity="0.65" points="249.5,62.53 249.5,137.5 314.48,174.94 314.48,99.97"/>\n            <polygon id="d" class="segment" clip-path="url(#cd)" points="184.52,400.03 184.52,325.061 314.48,250 314.48,325.061"/>\n            <polygon id="b" class="segment" clip-path="url(#cb)" points="314.48,174.94 314.48,99.97 184.52,174.94 184.52,250"/>\n        </svg>\n        <div class="message">\n            <p class="title">{{ title }}</p>\n            <p class="subtitle">{{ subtitle }}</p>\n        </div>\n    </div>\n</div>'),e.put("views/create/create.html",'\n<div class="container">\n    \n    <!-- preview -->\n\n    <x-preview id="preview" generator="generator" resized="previewResized( width, height )"></x-preview>\n\n    <!-- actions -->\n\n    <div id="actions">\n        \n        <button class="button undo">\n            <x-icon type="undo"></x-icon>\n        </button>\n\n        <button class="button redo">\n            <x-icon type="redo"></x-icon>\n        </button>\n\n        <button class="button shuffle">\n            <x-icon type="shuffle"></x-icon>\n        </button>\n\n        <button class="button fullscreen">\n            <x-icon type="fullscreen"></x-icon>\n        </button>\n\n        <button class="button help">\n            <x-icon type="help"></x-icon>\n        </button>\n\n    </div>\n\n    <!-- editor -->\n\n    <div id="editor">\n        \n        <x-gui class="gui" generator="generator"></x-gui>\n\n    </div>\n\n</div>\n\n<!-- info -->\n\n<div id="info">\n\n    <header class="header">\n        <h4 class="authors">{{ generator.authors | authors }}</h4>\n        <h3 class="name">{{ generator.name }}</h3>\n        <p class="description">{{ generator.description }}</p>\n    </header>\n\n</div>\n\n<!-- footer -->\n\n<footer id="footer">\n\n    <div class="create">\n\n        <div class="info">\n            All prints are single editions on gallery grade Gicl√©e acid-free paper with archival pigments\n        </div>\n\n        <div class="paper-select" ng-class="{ active: selectSize }">\n            <button class="toggle button outline light" ng-click="selectSize = !selectSize" stop-event="click">\n                {{ generator.options.paper.size.name }} - &pound;90\n                <x-icon type="arrow-down"></x-icon>\n            </button>\n            <div class="options">\n                <button class="button option"\n                    ng-repeat="size in paperSizes"\n                    ng-class="{ selected: generator.options.paper.size == size }"\n                    ng-click="generator.options.paper.size = size">\n                    <span class="name">{{ size.name }}</span>\n                    <span class="description">{{ size.description }}</span>\n                </button>\n            </div>\n        </div>\n\n        <button class="order button outline light" ng-click="checkout = true">Buy this print</button>\n\n    </div>\n\n</footer>\n\n<div class="overlay" ng-class="{ show: checkout }"></div>\n\n<!-- checkout -->\n\n<x-checkout\n    id="checkout"\n    generator="generator"\n    complete="checkoutComplete()"\n    cancel="checkout = false"\n    ng-class="{ active: checkout }">\n</x-checkout>\n'),e.put("views/home/home.html",'\n<!-- header -->\n\n<header id="header" ng-class="{ locked: headerLocked }">\n    \n    <h1 class="logo">\n        <a href="/">\n            <strong>stuvio</strong>\n        </a>\n    </h1>\n\n    <nav class="links primary">\n        <a href="#">Stuvio</a>\n        <a href="#">About</a>\n        <a href="#">Artists</a>\n        <a href="#">Blog</a>\n    </nav>\n\n    <nav class="links secondary">\n        <a href="#">Follow</a>\n        <a href="#">Contact</a>\n    </nav>\n\n</header>\n\n<!-- banner -->\n\n<section class="section banner" ng-style="{ height: bannerHeight + \'px\' }">\n\n    <div class="image"></div>\n    \n    <header class="header">\n        <h1 class="stuvio">Stuvio</h1>\n        <h2 class="title">Unique Affordable Art</h2>\n        <h3 class="description">Create one of a kind Generative artworks</h3>\n    </header>\n\n    <div class="cta">\n        <button class="create button outline light">Create yours</button>\n    </div>\n\n</section>\n\n<!-- about -->\n\n<section class="section about">\n    \n    <div class="wrapper" data-sr>\n        <h4 class="title">Generative Art Prints</h4>\n        <h5 class="description">Influence &amp; own high quality, totally unique single edition artworks</h5>\n    </div>\n\n</section>\n\n<!-- gallery -->\n\n<section class="section gallery">\n\n    <div class="wrapper">\n        <h4 class="title info">Select a generator to start creating</h4>\n        <article class="generator" ng-repeat="generator in generators track by generator.id">\n            <figure class="preview" ng-click="selectGenerator( generator )">\n                <!-- <div class="image" ng-style="{ backgroundImage: \'url(\' + \'/generators/example-generator/1.0/preview.jpg\' + \')\' }"> -->\n                <div class="image" ng-style="{ backgroundImage: \'url(http://lorempixel.com/1200/1200/abstract?t=\' + generator.id + \')\' }">\n                    <!-- <img ng-src="/generators/{{ generator.id }}/{{ generator.version }}/preview.jpg" alt="{{ generator.name }}"> -->\n                    <img ng-src="/generators/example-generator/1.0.0/preview.jpg" alt="{{ generator.name }}">\n                    <div class="tint"></div>\n                </div>\n                <figcaption class="details">\n                    <a ng-href="#/create/{{ generator.id }}/">\n                        <span class="authors">{{ generator.authors | authors }}</span>\n                        <span class="name">{{ generator.name }}</span>\n                        <span class="description">{{ generator.description }}</span>\n                        <span class="create">\n                            <em>generate yours &rsaquo;</em>\n                        </span>\n                    </a>\n                </figcaption>\n            </figure>\n        </article>\n    </div>\n    \n</section>\n\n<!-- signup -->\n\n<section class="section signup">\n    \n    <div class="wrapper">\n        \n        <h4 class="title info">More generators coming soon</h4>\n\n        <form id="signup" name="signup" novalidate="true">\n            <!-- <label class="status" for="mc-email">Coming soon</label> -->\n            <input id="mc-email" class="email" type="email" name="email" placeholder="Your Email address">\n            <button class="submit button outline" type="submit">Keep me posted</button>\n        </form>\n\n    </div>\n\n</section>\n\n<!-- footer -->\n\n<footer id="footer" class="section">\n    \n    <div class="wrapper">\n        \n        <div class="col">\n            <h5>&copy; Stuvio LTD 2015</h5>\n            <a href="#">About</a>\n            <a href="#">Artists</a>\n            <a href="#">Blog</a>\n        </div>\n\n        <div class="col">\n            <h5>Legal</h5>\n            <a href="#">Terms &amp; Conditions</a>\n        </div>\n        \n        <div class="col">\n            <h5>Contact</h5>\n            <a href="#">General enquiries</a>\n            <a href="#">Sell your work</a>\n            <a href="#">Commission work</a>\n            <a href="#">Bespoke Generators</a>\n        </div>\n        \n        <div class="col">\n            <h5>Follow</h5>\n            <a href="#">Twitter</a>\n            <a href="#">Facebook</a>\n        </div>\n\n    </div>\n\n</footer>'),e.put("components/gui/color/color.html",'\n<button class="input main" ng-click="active = !active" stop-event="click">\n    <svg class="swatch" viewBox="0 0 100 100">\n        <circle cx="50" cy="50"\n            ng-attr-stroke="{{ value }}"\n            ng-attr-stroke-width="{{ thickness }}"\n            ng-attr-r="{{ 50 - thickness / 2 }}"/>\n    </svg>\n    <div class="value">{{ formatHex( value ) }}</div>\n</button>\n\n<sv-label class="label"></sv-label>\n\n<div class="picker" ng-show="active" ng-style="{ top: pickerY + \'px\', left: pickerX + \'px\' }" stop-event="click">\n    <div class="shade">\n        <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" viewBox="0 0 100 100">\n            <defs>\n                <linearGradient id="gradient1" x1="0%" y1="0%" x2="100%" y2="0%" spreadMethod="pad">\n                    <stop offset="0%" ng-attr-stop-color="hsl({{ hue }},100%,50%)" stop-opacity="1"/>\n                    <stop offset="100%" ng-attr-stop-color="hsl({{ hue }},0%,50%)" stop-opacity="1"/>\n                </linearGradient>\n                <linearGradient id="gradient2" x1="0%" y1="0%" x2="0%" y2="100%" spreadMethod="pad">\n                    <stop offset="50%" stop-color="#000" stop-opacity="0"/>\n                    <stop offset="100%" stop-color="#000" stop-opacity="1"/>\n                </linearGradient>\n                <linearGradient id="gradient3" x1="0%" y1="0%" x2="0%" y2="100%" spreadMethod="pad">\n                    <stop offset="0%" stop-color="#fff" stop-opacity="1"/>\n                    <stop offset="50%" stop-color="#fff" stop-opacity="0"/>\n                </linearGradient>\n            </defs>\n            <rect x="0" y="0" width="100" height="100" fill="url(#gradient1)"/>\n            <rect x="0" y="0" width="100" height="100" fill="url(#gradient2)"/>\n            <rect x="0" y="0" width="100" height="100" fill="url(#gradient3)"/>\n        </svg>\n        <div class="handle" ng-style="{ left: 100 - saturation + \'%\', top: 100 - luminance + \'%\' }"></div>\n    </div>\n    <div class="color">\n        <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none">\n            <defs>\n                <linearGradient id="spectrum" x1="0%" y1="0%" x2="0%" y2="100%" spreadMethod="pad">\n                    <stop ng-repeat="(index, hue) in spectrum"\n                        ng-attr-offset="{{ ( index / spectrum.length ) * 100 }}%"\n                        ng-attr-stop-color="hsl({{ hue }},100%,50%)"\n                        stop-opacity="1"/>\n                </linearGradient>\n            </defs>\n            <rect x="0" y="0" width="100" height="100" fill="url(#spectrum)"/>\n        </svg>\n        <div class="track">\n            <div class="handle" ng-style="{ top: 100 - hue / 3.6 + \'%\' }"></div>\n        </div>\n    </div>\n    <div class="hex">\n        <input class="input" type="text" ng-model="hex" ng-change="setFromHex( hex )">\n    </div>\n</div>'),e.put("components/gui/audio/audio.html",'<button class="input main" ng-class="{ recording: recording }" ng-click="toggleRecording()">\n    <canvas class="spectrum"></canvas>\n    <svg class="svg" width="100%" height="100%" viewBox="0 0 100 100">\n        <circle\n            class="outline"\n            cx="50"\n            cy="50"\n            ng-attr-stroke-width="{{ thickness - 1 }}"\n            ng-attr-r="{{ 50 - thickness / 2 }}"/>\n        <path class="timer"\n            ng-attr-stroke-width="{{ thickness - 1 }}"\n            ng-attr-d="{{ arc( 50, 50, 50 - thickness / 2, -90, -90 + ( ellapsed / duration[1] ) * 355 ) }}"/>\n        <g transform="translate( 50, 50 )">\n            <use class="icon microphone" xlink:href="#microphone" x="-15" y="-15" width="30" height="30"></use>\n            <!-- <rect class="icon stop" x="-10" y="-10" width="20" height="20"/> -->\n        </g>\n    </svg>\n</button>\n<sv-label class="label"></sv-label>'),e.put("components/gui/image/image.html",'<div class="input main">\n    <div class="preview" ng-style="{ \'background-image\': \'url(\' + setting.value.src + \')\' }"></div>\n    <button class="upload" title="Upload image">\n        <input class="file" type="file" accept="image/*" onchange="angular.element( this ).scope().fileChanged( this )"/>\n        <x-icon type="upload"/>\n    </button>\n</div>\n<sv-label class="label"></sv-label>'),e.put("components/gui/label/label.html",'<span class="name">{{ name }} <span class="unit" ng-if="unit">({{ unit }})</span></span>\n<span class="description">{{ description }}</span>'),e.put("components/gui/number/number.html",'<input class="input" type="number" min="{{ min }}" max="{{ max }}" step="{{ step }}">\n<button class="step inc" ng-click="inc()"><x-icon type="arrow-up"/></button>\n<button class="step dec" ng-click="dec()"><x-icon type="arrow-down"/></button>'),e.put("components/gui/slider/slider.html",'<div class="input main">\n    <svg class="circle" viewBox="0 0 100 100">\n        <circle class="track" cx="50" cy="50"\n            ng-attr-stroke-width="{{ thickness - 2 }}"\n            ng-attr-r="{{ 50 - thickness / 2 }}"/>\n        <path class="bar"\n            ng-attr-stroke-width="{{ thickness }}"\n            ng-attr-d="{{ arc( 50, 50, 50 - thickness / 2, gamma, theta ) }}"/>\n    </svg>\n    <x-number class="value min"\n        ng-if="isRange"\n        min="range[0]"\n        max="values[1]"\n        value="values[0]"\n        step="step"/>\n    </x-number>\n    <x-number class="value max"\n        min="isRange ? values[0] : range[0]"\n        max="range[1]" value="values[1]"\n        step="step"/>\n    </x-number>\n</div>\n<sv-label class="label"></sv-label>'),e.put("components/gui/string/string.html",'<button class="input main">\n    <svg width="100%" height="100%" viewBox="0 0 100 100">\n        <circle\n            class="outline"\n            cx="50"\n            cy="50"\n            ng-attr-stroke-width="{{ thickness - 1 }}"\n            ng-attr-r="{{ 50 - thickness / 2 }}"/>\n    </svg>\n    <input class="value" ng-model="value" ng-style="{ fontSize: fontSize + \'px\' }"/>\n</button>\n<sv-label class="label"></sv-label>'),e.put("components/gui/toggle/toggle.html",'<button class="input main" ng-class="{ active: value }" ng-click="value = !value">\n    <svg width="100%" height="100%" viewBox="0 0 100 100">\n        <circle\n            class="outline"\n            cx="50"\n            cy="50"\n            ng-attr-stroke-width="{{ thickness - 1 }}"\n            ng-attr-r="{{ 50 - thickness / 2 }}"/>\n        <g transform="translate( 50, 50 )">\n            <use class="icon check" xlink:href="#check" x="-16" y="-16" width="32" height="32"></use>\n            <use class="icon cross" xlink:href="#cross" x="-16" y="-16" width="32" height="32"></use>\n        </g>\n    </svg>\n</button>\n<sv-label class="label"></sv-label>')
}]);var n=function(){function e(e){var n=e.toString(16);return 1==n.length?"0"+n:n}function n(e){var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(n,function(e,n,t,r){return n+n+t+t+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]}function t(n){return"#"+e(n[0])+e(n[1])+e(n[2])}function r(e){var n,t,r=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.max(r,i,o),s=Math.min(r,i,o),l=(s+a)/2;if(s==a)n=t=0;else{var c=a-s;switch(t=l>.5?c/(2-s-a):c/(a+s),a){case r:n=(i-o)/c+(o>i?6:0);break;case i:n=(o-r)/c+2;break;case o:n=(r-i)/c+4}n/=6}return[360*n,100*t,100*l]}function i(e,n,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?e+6*(n-e)*t:.5>t?n:2/3>t?e+(n-e)*(2/3-t)*6:e}function o(e){var n,t,r,o=e[0]/360,a=e[1]/100,s=e[2]/100;if(0==a)n=t=r=s;else{var l=.5>s?s*(1+a):s+a-s*a,c=2*s-l;n=i(c,l,o+1/3),t=i(c,l,o),r=i(c,l,o-1/3)}return[Math.round(255*n),Math.round(255*t),Math.round(255*r)]}function a(e){return r(n(e))}function s(e){return t(o(e))}return{HEXtoRGB:n,HEXtoHSL:a,RGBtoHEX:t,RGBtoHSL:r,HSLtoHEX:s,HSLtoRGB:o}}(),t=function(){var e=Math.PI/180;return{arc:function(n,t,r,i,o){var a=i*e,s=o*e,l=n+Math.cos(s)*r,c=t+Math.sin(s)*r,u=n+Math.cos(a)*r,d=t+Math.sin(a)*r,p=180>=o-i?"0":"1";return["M",l,c,"A",r,r,0,p,0,u,d].join(" ")}}}();angular.module("stuvio").service("ModalService",["$q","$rootScope",function(n,t){var r={open:function(e,n){t.$emit("modal:open",e,n)},alert:function(n){r.open("alert",e.merge(n||{},{options:[{label:"ok"}]}))},confirm:function(n){r.open("confirm",e.merge(n||{},{options:[{label:"ok"},{label:"cancel"}]}))},error:function(n){r.open("error",e.merge(n||{},{options:[{label:"ok"}]}))}};return r}]),angular.module("stuvio").service("AudioService",[function(){function e(e){for(var n=[],t=0,r=e.length;r>t;t++)n[t]=e[t];return n}function n(e){for(var n=0,t=0,r=e.length;r>t;t++)n+=e[t];return n/r}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.AudioContext=window.AudioContext||window.webkitAudioContext;var t,r,i,o,a=1/30,s=256,l=new AudioContext,c=-1,u={timeDomainData:[],frequencyData:[],volumeData:[],start:function(d){d=d||{},d.interval=d.interval||a,d.bands=d.bands||s,navigator.getUserMedia({audio:!0},function(a){function s(){c=setTimeout(s,1e3*d.interval);var r=new Uint8Array(t.frequencyBinCount),i=new Uint8Array(t.frequencyBinCount);t.getByteTimeDomainData(r),t.getByteFrequencyData(i);var o={timeDomainData:e(r),frequencyData:e(i),volume:n(i)/255};u.timeDomainData.push(o.timeDomainData),u.frequencyData.push(o.frequencyData),u.volumeData.push(o.volume);var a=Date.now();g+=a-p,p=a,d.update&&d.update(g/1e3,o)}o=a;var p=Date.now(),g=0;u.timeDomainData.length=0,u.frequencyData.length=0,u.volumeData.length=0,r=l.createGain(),i=l.createMediaStreamSource(o),t=l.createAnalyser(),t.fftSize=2*d.bands,i.connect(r),i.connect(t),freqBuffer=new Uint8Array(t.frequencyBinCount),timeBuffer=new Uint8Array(t.frequencyBinCount),d.success&&d.success(o),s()},function(e){d.error&&d.error(e)})},stop:function(){o.stop(),i.disconnect(r),i.disconnect(t),clearTimeout(c)}};return u}]),angular.module("stuvio").service("DragService",[function(){function e(e){e.preventDefault();var n=e.changedTouches?e.changedTouches[0]:e;return{x:n.clientX,y:n.clientY}}var n=angular.element(document),t={bind:function(t,r){function i(t){n.on("mouseup mouseleave touchend",a),n.on("mousemove touchmove",o),r.start&&r.start(e(t))}function o(n){r.move&&r.move(e(n))}function a(t){n.off("mouseup mouseleave touchend",a),n.off("mousemove touchmove",o),r.end&&r.end(e(t))}t.on("mousedown touchstart",i)}};return t}]),angular.module("stuvio").service("DropService",[function(){function n(e){e.stopPropagation(),e.preventDefault()}var t={bind:function(t,r){t.on("dragenter",function(e){n(e),r.enter&&r.enter(e)}),t.on("dragover",function(){n(event),r.over&&r.over(event)}),t.on("drop",function(t){if(n(t),r.drop){var i=t.dataTransfer.files;r.filter&&(i=e.filter(t.dataTransfer.files,function(e){return console.log(r.filter,e.type,r.filter.test(e.type)),r.filter.test(e.type)}),console.log(i)),r.drop(i)}})}};return t}]),angular.module("stuvio").service("FileService",["$q","$http",function(e,n){var t=!0,r=self.URL||self.webkitURL,i={filesByURL:{},fileToBlobURL:function(n){return e(function(e){var o=r.createObjectURL(n);t&&(i.filesByURL[o]=n),e(o)})},blobToArray:function(n){return e(function(e,t){var r=new FileReader;r.onload=function(){for(var n=new Uint8Array(r.result),t=new Array(n.length),i=0,o=t.length;o>i;i++)t[i]=n[i];e(t)},r.onerror=t,r.readAsArrayBuffer(n)})},blobURLToFile:function(t){return e(function(e,r){i.filesByURL[t]?e(i.filesByURL[t]):n.get(t,{transformRequest:angular.identity,responseType:"blob"}).then(function(n){e(n.data)},r)})},fileToDataURL:function(n){return e(function(e,r){var o=new FileReader;o.onload=function(){var r=o.result;t&&(i.filesByURL[r]=n),e(r)},o.onerror=r,o.readAsDataURL(n)})},dataURLToFile:function(n){return e(function(e){if(i.filesByURL[n])e(i.filesByURL[n]);else{for(var t=n.split(","),r=(/base64/.test(t[0])?atob:unescape)(t[1]),o=t[0].split(":")[1].split(";")[0],a=new Uint8Array(r.length),s=0,l=r.length;l>s;s++)a[s]=r.charCodeAt(s);e(new Blob([a],{type:o}))}})}};return i}]),angular.module("stuvio.components",["ngSanitize"]).filter("precision",function(){return function(e,n,t){var r=n.toString().replace(/[^.]+\.?/,"").length,i=e.toFixed(r);return t?i.replace(/(\d+)\.(\d+)/,"$1<em>.$2</em>"):i}}).filter("map",function(){return function(e,n,t){return Math.map(e,n[0],n[1],t[0],t[1])}}).filter("clamp",function(){return function(e,n,t){return Math.clamp(e,n,t)}}).filter("percent",function(){return function(e,n){return n&&(e*=100),e+"%"}}).directive("stopEvent",function(){return{restrict:"A",link:function(e,n,t){n.bind(t.stopEvent,function(e){e.stopPropagation()})}}}),angular.module("stuvio.components").directive("modal",[function(){return{restrict:"EA",templateUrl:"components/modal/modal.html",replace:!0,scope:{},controller:["$scope","$rootScope","$element","$timeout",function(n,t,r,i){t.$on("modal:open",function(e,t,r){n.open(t,r)}),n.open=function(e,t){i(function(){n.show=!0,n.mode=e,n.config=t})},n.close=function(t){e.isFunction(t)&&t(),n.show=!1}}]}}]),angular.module("stuvio.components").directive("icon",[function(){var e="http://www.w3.org/1999/xlink",n="http://www.w3.org/2000/svg";return{restrict:"EA",replace:!0,template:'<svg class="icon" viewBox="0 0 100 100"></svg>',link:function(t,r,i){var o=document.createElementNS(n,"use");o.setAttributeNS(e,"href","#"+i.type),r[0].appendChild(o)}}}]),angular.module("stuvio.components").directive("preview",[function(){return{restrict:"E",templateUrl:"components/preview/preview.html",scope:{generator:"=",resized:"&"},controller:["$scope","$element","GeneratorService",function(e,n,t){function r(){window.addEventListener("resize",i)}function i(){var n=s.clientHeight-2*a,r=s.clientWidth-2*a,i=Math.SQRT2,d=1,p=d/i,g=r/n,h=p>=g?r/d:n/i,m=Math.round(i*h),v=Math.round(d*h);if(u.style.height=m+"px",u.style.width=v+"px",u.style.left=a+r/2-v/2+"px",u.style.top=a+n/2-m/2+"px",o){var f=c.clientHeight,b=c.clientWidth;o.height=f*l,o.width=b*l,o.style.height=f+"px",o.style.width=b+"px",t.generate(),e.resized({height:m,width:v})}}var o,a=0,s=n[0],l=window.devicePixelRatio,c=s.querySelector(".content"),u=s.querySelector(".frame");e.$watch("generator.context",function(e){e&&(o=e.canvas,angular.element(c).empty().append(o),i())}),r()}]}}]),angular.module("stuvio.components").directive("gui",[function(){return{restrict:"E",templateUrl:"components/gui/gui.html",scope:{generator:"="},controller:["$scope","$element",function(){function e(){}e()}]}}]),angular.module("stuvio.components").directive("number",[function(){return{restrict:"E",templateUrl:"components/gui/number/number.html",scope:{value:"=",step:"=",min:"=",max:"="},controller:["$scope","$element",function(e,n){function t(){a.on("input",o)}function r(n){var t=Math.min(e.step.toString().replace(/[^.]+\.?/,"").length,4);return n.toFixed(t)}function i(n){e.value=Math.clamp(parseFloat(e.value)+e.step*n,e.min,e.max)}function o(){var n=parseFloat(a.val());n=Math.clamp(n,e.min,e.max),isNaN(n)||e.$apply(function(){e.value=n})}var a=angular.element(n[0].querySelector(".input"));e.inc=function(){i(1)},e.dec=function(){i(-1)},e.$watch("value",function(e){a.val(r(e))}),t()}]}}]),angular.module("stuvio.components").directive("slider",[function(){return{restrict:"E",templateUrl:"components/gui/slider/slider.html",scope:{description:"=",format:"&",label:"=",range:"=",value:"=",step:"=",unit:"=",name:"="},controller:["$scope","$element","DragService",function(n,r,i){function o(){n.thickness=6,n.arc=t.arc,n.isRange&&r.addClass("range"),i.bind(d,{start:function(e){p.bounds=p[0].getBoundingClientRect(),p.bounds.cx=p.bounds.left+p.bounds.width/2,p.bounds.cy=p.bounds.top+p.bounds.height/2,l(e),s(e,!1)},move:c,end:c})}function a(e){var n=e.x-p.bounds.cx,t=e.y-p.bounds.cy,r=Math.atan2(t,n)+Math.HALF_PI;return r>Math.PI&&(r-=Math.TWO_PI),0>r&&(r+=Math.TWO_PI),r}function s(e,t){var r=Math.map(n.values[0],n.range[0],n.range[1],0,Math.TWO_PI),i=Math.map(n.values[1],n.range[0],n.range[1],0,Math.TWO_PI),o=a(e),s=u?i:r,l=o-s;t&&(l=Math.atan2(Math.sin(l),Math.cos(l))),o=Math.sign(l)>0?1>u?Math.clamp(o,s,i):Math.clamp(o,s,Math.TWO_PI):1>u?Math.clamp(o,0,s):Math.clamp(o,r,s);var c=Math.map(o,0,Math.TWO_PI,n.range[0],n.range[1]);n.values[u]=Math.step(c,n.step),n.$apply()}function l(e){if(n.isRange){var t=a(e),r=Math.map(n.values[0],n.range[0],n.range[1],0,Math.TWO_PI)-Math.EPS,i=Math.map(n.values[1],n.range[0],n.range[1],0,Math.TWO_PI)+Math.EPS,o=Math.abs(t-r),s=Math.abs(t-i);u=s>o?0:1}else u=1}function c(e){s(e,!0)}var u,d=angular.element(r[0].querySelector(".circle")),p=angular.element(r[0].querySelector(".input"));n.isRange=e.isArray(n.value),n.values=[n.isRange?n.value[0]:n.range[0],n.isRange?n.value[1]:n.value],n.precision=function(e,n){var t=n>=1?0:n.toString().replace(/^\d+\./,"").length;return e.toFixed(t)},n.$watch("values",function(){n.value=n.isRange?[n.values[0],n.values[1]]:n.values[1];var e=Math.map(n.values[0],n.range[0],n.range[1],0,360),t=Math.map(n.values[1],n.range[0],n.range[1],0,360);n.gamma=Math.max(e-2,Math.EPS)-90,n.theta=Math.min(t+2,360-Math.EPS)-90},!0),o()}]}}]),angular.module("stuvio.components").directive("string",[function(){return{restrict:"E",templateUrl:"components/gui/string/string.html",scope:{description:"=",value:"=",name:"="},controller:["$scope","$element",function(e,n){function t(){e.thickness=6}var r=n[0].querySelector(".value");e.$watch("value",function(n){var t=12,r=24,i=n.length-1,o=7,a=r-t,s=a/o,l=r-i*s;e.fontSize=Math.min(r,Math.max(t,l))}),e.focusInput=function(){r.setSelectionRange(0,e.value.length),r.focus()},t()}]}}]),angular.module("stuvio.components").directive("toggle",[function(){return{restrict:"E",templateUrl:"components/gui/toggle/toggle.html",scope:{description:"=",value:"=",name:"="},controller:["$scope","$element",function(e){function n(){e.thickness=6}n()}]}}]),angular.module("stuvio.components").directive("audio",[function(){return{restrict:"E",templateUrl:"components/gui/audio/audio.html",scope:{description:"=",interval:"=",duration:"=",bands:"=",value:"=",name:"="},controller:["$scope","$element","$timeout","AudioService","ModalService",function(n,r,i,o,a){function s(){n.thickness=6,n.ellapsed=0,n.arc=t.arc,e.isNumber(n.duration)&&(n.duration=[0,n.duration]),null==n.interval&&(n.interval=1/30),null==n.duration&&(n.duration=[1,10]),null==n.bands&&(n.bands=128),window.addEventListener("resize",d),d()}function l(){var e=o.timeDomainData.length;if(e){p.width=p.width;var n=p.width/2,t=o.timeDomainData[e-1],r=p.width/t.length,i=.9*p.height,a=.5*p.height;h.translate(-.5,-.5),h.scale(g,g),h.beginPath(),h.arc(n,n,n-2,0,Math.TWO_PI),h.clip();for(var s=0,l=t.length;l>s;s++)(s?h.lineTo:h.moveTo).call(h,s*r,a+i*((t[s]-128)/255));h.strokeStyle="#000",h.lineWidth=1,h.lineJoin="round",h.stroke()}}function c(){o.start({interval:n.interval,bands:n.bands,success:function(){p.width=p.width,i(function(){n.recording=!0})},update:function(e){i(function(){n.ellapsed=e}),e>=n.duration[1]?u():l()},error:function(){a.error({title:"You must allow microphone access",message:"Click in the top right"}),n.recording=!1}})}function u(){o.stop(),n.ellapsed<n.duration[0]?a.error({title:"Recording not long enough",message:"Your recording must be at least "+n.duration[0]+" seconds"}):n.value=o.frequencyData,i(function(){n.recording=!1})}function d(){p.height=p.clientHeight*g,p.width=p.clientWidth*g,n.recording&&l()}var p=r[0].querySelector(".spectrum"),g=window.devicePixelRatio||1,h=p.getContext("2d");n.toggleRecording=function(){n.recording?u():c()},n.$on("$destroy",function(){window.removeEventListener("resize",d)}),s()}]}}]),angular.module("stuvio.components").directive("color",[function(){return{restrict:"E",templateUrl:"components/gui/color/color.html",scope:{description:"=",value:"=",name:"="},controller:["$scope","$element","DragService",function(e,t,r){function i(){e.thickness=6,e.spectrum=function(){for(var e=10,n=360/e,t=[],r=0;n>=r;r++)t.unshift(e*r);return t}(),r.bind(b,{start:function(e){s(b,e)},move:l,end:l}),r.bind(y,{start:function(e){s(y,e)},move:l,end:l})}function o(e){for(var n;e.parentNode;){if(n=window.getComputedStyle(e.parentNode).getPropertyValue("overflow"),/auto|scroll/.test(n))return e.parentNode;e=e.parentNode}}function a(){var n=t[0].getBoundingClientRect();e.pickerX=n.left+70,e.pickerY=Math.min(window.innerHeight-m,Math.max(0,n.top+n.height/2-m/2)),e.pickerX+v>window.innerWidth-10&&(e.pickerX=n.left-v-20)}function s(e,n){g=e[0].getBoundingClientRect(),h=e,l(n)}function l(n){var t=Math.clamp(n.x-g.left,0,g.width)/g.width,r=Math.clamp(n.y-g.top,0,g.height)/g.height;e.$apply(function(){h===y?e.hue=360*(1-r):(e.saturation=100*(1-t),e.luminance=100*(1-r)),e.updateHex()})}function c(n){n.stopPropagation(),n.preventDefault(),e.$apply(function(){e.active=!1})}function u(){a(),e.$apply()}function d(){a(),e.$apply()}var p,g,h,m=195,v=195,f=(angular.element(t[0].querySelector(".swatch")),angular.element(t[0].querySelector(".picker"))),b=angular.element(t[0].querySelector(".picker .shade")),y=angular.element(t[0].querySelector(".picker .color")),w=angular.element(document),x=angular.element(window);e.formatHex=function(e){return e.replace(/[^\da-f]/gi,"")},e.updateHex=function(){null!=e.hue&&null!=e.saturation&&null!=e.luminance&&(e.value=n.HSLtoHEX([Math.clamp(e.hue,0,360),Math.clamp(e.saturation,0,100),Math.clamp(e.luminance,0,100)]))},e.setFromHex=function(t){if(t=t.replace(/^#/,""),/^[A-Z0-9]{6}$/i.test(t)){var r=n.HEXtoHSL(t);e.hue=r[0],e.saturation=r[1],e.luminance=r[2],e.value="#"+t}},e.$watch("active",function(){e.active?(document.body.appendChild(f[0]),p||(p=angular.element(o(t[0]))),p.on("scroll",d),w.on("click",c),x.on("resize",u),a()):(f[0].parentNode&&f[0].parentNode.removeChild(f[0]),p&&p.off("scroll",d),w.off("click",c),x.off("resize",u))}),e.$watch("value",function(n){n&&null==e.hue&&e.setFromHex(n),e.hex=n.replace(/[^a-f0-9]/gi,"")}),i()}]}}]),angular.module("stuvio.components").directive("image",[function(){return{restrict:"E",templateUrl:"components/gui/image/image.html",scope:{description:"=",setting:"=",name:"="},controller:["$scope","$element","FileService","DropService",function(e,n,t,r){function i(){r.bind(n,{filter:/^image.*/i,drop:function(e){o(e[0])}})}function o(n){t.fileToBlobURL(n).then(function(n){var t=new Image;t.onload=function(){e.setting.value=t,e.$apply()},t.src=n})}e.fileChanged=function(e){o(e.files[0])},i()}]}}]),angular.module("stuvio.components").directive("svLabel",[function(){return{restrict:"E",templateUrl:"components/gui/label/label.html",scope:!1}}])}();